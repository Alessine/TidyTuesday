---
title: "210420_tidytuesday_netflixshows"
author: "Angela"
date: "4/20/2021"
output: html_document
---

```{r}
library(tidytuesdayR)
library(tidyverse)
library(stringr)
```


```{r}
# Read in the data from the tidy tuesday library.
#tuesdata <- tidytuesdayR::tt_load(2021, week = 17)
df_netflix_shows <- data.frame(tuesdata[1])
```


```{r}
df_netflix_movies <- df_netflix_shows %>%
  separate(netflix_titles.country, "first_country", ",") %>%  
  filter(netflix_titles.type == "Movie" & 
           between(netflix_titles.release_year, 2000, 2021) &
           !is.na(first_country))

```


```{r}
df_netflix_movies %>% 
  group_by(netflix_titles.release_year, first_country) %>%
  count(first_country) %>%
  filter(n > 10) %>%
  ggplot(aes(netflix_titles.release_year, n, fill = first_country)) +
  geom_bar(stat = "identity", show.legend = TRUE) +
  theme_light() +
  scale_fill_discrete()
```

```{r}
countries_list <- df_netflix_shows %>% 
  separate(netflix_titles.country, "first_country", ",") %>%
  group_by(first_country) %>%
  count(first_country) %>%
  arrange(desc(n)) %>%
  filter(!is.na(first_country)) %>%
  .$first_country

countries_list[1:10]
```
```{r}
df_netflix_shows %>% 
  separate(netflix_titles.country, "first_country", ",") %>%  
  filter(first_country %in% countries_list[1:10] &
           netflix_titles.type == "Movie") %>%

  ggplot(aes(fct_rev(first_country), netflix_titles.release_year, fill = first_country)) +
  geom_violin(alpha = 0.7, show.legend = FALSE) +
  coord_flip() +
  theme_classic()


```

```{r, fig.width = 12}
library("vioplot")
library(stringr)
vioplot_movies <- df_netflix_shows %>% 
  separate(netflix_titles.country, "first_country", ",") %>%  
  filter(first_country %in% countries_list[1:10] &
           netflix_titles.type == "Movie")

vioplot_movies$first_country <- str_replace_all(vioplot_movies$first_country, " ", "\n")

vioplot_shows <- df_netflix_shows %>% 
  separate(netflix_titles.country, "first_country", ",") %>%  
  filter(first_country %in% countries_list[1:10] &
           netflix_titles.type == "TV Show")

vioplot(netflix_titles.release_year~first_country, data=vioplot_movies, col = "palevioletred", plotCentre = "line", side = "right")
vioplot(netflix_titles.release_year~first_country, data=vioplot_shows, col = "lightblue", plotCentre = "line", side = "left", add = T)
legend("bottomleft", fill = c("lightblue", "palevioletred"), legend = c("TV Shows", "Movies"))
```



```{r}
# Look for specific actors

sum(str_detect(df_netflix_shows$netflix_titles.cast, "Shah Rukh Khan"), na.rm = TRUE)
```


