---
title: "210504_tidytuesday_olympics"
author: "Angela"
date: "28/7/2021"
output: html_document
---

```{r}
knitr::opts_chunk$set(echo = FALSE, messages = FALSE, warnings = FALSE)
```

```{r}
library(tidyverse)
library(tidytuesdayR)
library(waffle)
library(extrafont)

```


```{r}
# Read in the data from the tidy tuesday library.
tuesdata <- tidytuesdayR::tt_load('2021-07-27')
readme(tuesdata)

olympics <- tuesdata$olympics
regions <- tuesdata$regions
```

```{r}
head(olympics)
```



```{r}
medals_by_athlete <- olympics %>%
  filter(! is.na(medal)) %>%
  group_by(name, medal) %>%
  summarize(n = n(), team = team[1]) %>%
  arrange(desc(n))

medals_by_athlete
```

```{r}
phelps <- medals_by_athlete %>%
  filter(name == "Michael Fred Phelps, II")

waffle_parts <- phelps$n
names(waffle_parts) <- phelps$medal
  
```

```{r}
w1 <- waffle(waffle_parts, rows = 3, title = phelps$name)
w1
```

```{r}
top_athletes <- olympics %>%
  filter(medal == "Gold") %>%
  group_by(name) %>%
  summarize(n = n()) %>%
  arrange(desc(n)) %>%
  filter(n >= 8) %>%
  select(-n)
```

```{r}
olympics %>%
  filter(name %in% top_athletes$name) %>%
  group_by(name, medal) %>%
  summarize(n = n()) %>%
  ggplot(aes(fill = medal, values = n)) +
  geom_waffle() +
  facet_grid(name~.)
  
```


```{r}
medals_by_athlete %>%
  filter(n > 8) %>%
  ggplot(aes(fill = medal, values = n)) +
  geom_waffle() +
  facet_grid(.~name)
```

